---
title: "Project Documentation"
output: html_notebook
---
Feb 14th
```{r}
parse_date("4/1/2015", "%m/%d/%Y")
# parses our date successfully

parse_time("0:21:00")
```
```{r}
# This is for future reference, for now we are good.
uber$date <- as.Date(data$Date/Time) # add date column
uber$time <- format(as.POSIXct(data$Date/Time),format = "%H:%M:%S") # add time column
# source: https://statisticsglobe.com/split-date-time-column-into-separate-variables-in-r

```

Feb 16th

4:00 pm to 5 pm: working on tidying data and writing cleaned dataset to a new file. 


```{r}
# separating date and time from Date/Time column

new_uber <- uber %>%
  separate('Date/Time', into = c("date", "time"), sep = " ")
```

Feb 17th
10 am to 11 am installed ggmap, set up Google cloud account and set up the api key.

Ran into this error when playing around: Discrete value supplied to continuous scale. This happens when applying aes to a categorical value when I put the column name in quotes.

Also ran into a problem where get_map() requires additional API authorization but it is resolved by lifting the restriction from the cloud platform.

```{r}
ggmap(nyc_map) + 
    geom_point(data = uber, aes(x= Lon,y= Lat), size=0.15,alpha=.3)
```
```{r}
#Run this line before using ggmap
register_google(key = "AIzaSyAnGi82u7r4pOg8fYXC_dugPcMeiA2OMf8")
```

```{r}
nyc.map <- get_map(location= 'Lower Manhattan, New York', 
                       maptype='roadmap', color='color',source='google',zoom=14)

ggmap(nyc.map) + 
    geom_point(data = uber, aes(x= Lon,y= Lat), size=0.15,alpha=.3)
```

Feb 18th
In-class: worked on connecting slider bar input to the zoom ratio to change the map zoom specification.

4 pm to 4:30 pm: working on changing the date format and creating the reactive component of my shiny app.
```{r}
# changed the date format to accomendate sliderInput in Shiny
new_uber <- uber %>%
  separate('Date/Time', into = c("date", "time"), sep = " ") %>%
  mutate(date = mdy(date))
```

I was looking into how to connect the date range input to the dataset, but was having a little trouble doing that, might need more research. 
```{r}
server <- function(input, output) {

    output$pickupPlot <- renderPlot({
        nyc.map <- get_map(location= 'Lower Manhattan, New York', 
                           maptype='roadmap', color='color',source='google', zoom = input$zoom)
        
        ggmap(nyc.map) + 
            geom_point(data = uber, aes(x= Lon,y= Lat), size=0.3,alpha=.3)
        # specifically select 'uber' based on the date from the input.
        
    })
}
```

Feb 19th

2:30pm-3pm
Playing around with printing the date range using dateRangeinput from Shiny app demo page

8:30pm-9:30pm
Working on selecting my dataset based on date range and apply to the ploting. 
```{r}
#testing selectByDate
output$dateRangeText  <- renderPrint({
        start_date <- format(input$dateRange[1], "%Y-%m-%d")
        end_date <- format(input$dateRange[2], "%Y-%m-%d")
        selectByDate(uber, start = start_date, end = end_date)
    })
# renderPlot
output$pickupPlot <- renderPlot({
        start_date <- format(input$dateRange[1], "%Y-%m-%d")
        end_date <- format(input$dateRange[2], "%Y-%m-%d")
        uberWithDate <- selectByDate(uber, start = start_date, end = end_date, month = c(5, 6), day = 1:31)
        
        nyc.map <- get_map(location= 'Lower Manhattan, New York',
                           maptype='roadmap', color='color',source='google', zoom = input$zoom)

        ggmap(nyc.map) +
            geom_point(data = uberWithDate, aes(x= Lon,y= Lat), size=0.3,alpha=.3)
    })
```

Next thing I want to work on is make each data point clicable or interactive. 

2/21
9-9:30pm: researching on how to make ggmap interactive and learned more about reactivity. Found a library called googleway.

2/22
8:30-9:30am: found leaflet and played around with it. I made a new shiny app to accommodate the new package and shinydashboard. 
```{r}
library(leaflet)

m <- leaflet("New York City") %>%
  addTiles() %>%  # Add default OpenStreetMap map tiles
  addMarkers(lng=-90.321, lat=40.31, popup="The birthplace of R")
m  # Print the map
```
2/26
4-5pm: went to Mingi's Mentor session and worked on mutating the data to show Uber pickups in different regions. 

2/27
12:30 - 2pm: working on leaflet and made a basic choropleth map of NYC
```{r}
library(tigris)
library(dplyr)
library(leaflet)

# Downloading the shapefiles for states at the lowest resolution
nyc <- county_subdivisions("New York", c("Bronx", "Kings", "New York", "Queens", "Richmond"))

nyc %>%
  leaflet() %>%
  addTiles() %>%
  addPolygons(popup=~NAME)
```
Next step: clean data to add a county column using revgeocode



